# Syncrescendence Platform Constellation Coordination
# Defines zone ownership, platform specialization, and conflict prevention
# Authority: CANON-25200-CONSTELLATION_ARCH
# Version: 2.1.0
# Updated: 2026-01-11
# Change: Added model_routing section per Oracle 12 decision

coordination:
  version: "2.1.0"
  updated: "2026-01-11"

  # Platform Constellation ($100/month total)
  platforms:
    claude:
      accounts: 3
      tier: pro
      monthly_cost: 60

    gemini:
      accounts: 1
      tier: advanced
      monthly_cost: 20

    chatgpt:
      accounts: 1
      tier: plus
      monthly_cost: 20
      email: "truongphillipthanh@icloud.com"

  total_monthly: 100
  sustainability_target: "2026-01-31"

  # Account definitions
  accounts:
    # Claude Accounts (3x Pro)
    oracle:
      name: "Oracle Thread"
      platform: "claude"
      role: "Strategic synthesis"
      surface: "web"
      worktree: null
      branch_prefix: null
      function: "strategic_synthesis"
      capabilities:
        - "project_memory"
        - "deep_research"
        - "artifacts"
        - "analysis_tool"
      notes: "Read-only repo access via MCP/exports"

    alpha:
      name: "Claude Instance Alpha"
      platform: "claude"
      role: "Primary executor"
      surface: "code"
      worktree: "../syncrescendence-alpha"
      branch_prefix: "alpha/"
      function: "execution"
      zone: "alpha"

    beta:
      name: "Claude Instance Beta"
      platform: "claude"
      role: "Parallel executor"
      surface: "code"
      worktree: "../syncrescendence-beta"
      branch_prefix: "beta/"
      function: "execution"
      zone: "beta"

    # Gemini Account (1x Advanced)
    gemini:
      name: "Gemini Ingestion"
      platform: "gemini"
      role: "Ingestion layer"
      surface: "cli"
      worktree: null
      branch_prefix: "gemini/"
      function: "ingestion"
      capabilities:
        - "youtube_processing"
        - "2m_context"
        - "video_multimodal"
        - "jules_async"
      notes: "263 tok/sec video processing"

    # ChatGPT Account (1x Plus)
    chatgpt:
      name: "ChatGPT Reasoning"
      platform: "chatgpt"
      role: "Reasoning + GitHub"
      surface: "codex_cli"
      worktree: null
      branch_prefix: null
      function: "reasoning"
      capabilities:
        - "codex_cli"
        - "github_codex"
        - "gpt52_reasoning"
        - "voice"
      notes: "@codex for PR reviews"

  # Zone ownership (exclusive write access)
  zones:
    alpha:
      writable:
        - "04-SOURCES/processed/a-*"
        - "00-ORCHESTRATION/logs/*-A.md"
      description: "Stream A processing and logging"

    beta:
      writable:
        - "04-SOURCES/processed/b-*"
        - "00-ORCHESTRATION/logs/*-B.md"
      description: "Stream B processing and logging"

    gemini:
      writable:
        - "04-SOURCES/raw/*"
        - "04-SOURCES/processed/g-*"
      description: "Source ingestion and YouTube processing"

    chatgpt:
      writable:
        - ".github/*"
      description: "GitHub workflow configuration via Codex"

    shared:
      writable:
        - "00-ORCHESTRATION/state/*.csv"
        - "04-SOURCES/sources.csv"
      pattern: "append_only"
      description: "Ledgers use append-only pattern with row-level locking"

  # Task routing by type
  routing:
    youtube_processing:
      primary: "gemini"
      rationale: "Native 263 tok/sec multimodal"

    production_code:
      primary: "alpha"
      secondary: "beta"
      rationale: "Repository access, zone ownership"

    strategic_synthesis:
      primary: "oracle"
      secondary: "chatgpt"
      rationale: "Deep Research, project memory"

    large_corpus:
      primary: "gemini"
      rationale: "2M context window"

    github_workflows:
      primary: "chatgpt"
      rationale: "@codex integration"

    abstract_reasoning:
      primary: "chatgpt"
      secondary: "oracle"
      rationale: "GPT-5.2 capability"

    source_integration:
      primary: "alpha"
      secondary: "beta"
      rationale: "CANON access required"

    parallel_execution:
      primary: ["alpha", "beta"]
      rationale: "Multi-stream directives"

  # Model routing by task type
  model_routing:
    default: sonnet-4.5
    by_task_type:
      oracle_synthesis: opus-4.5
      architectural_decisions: opus-4.5
      complex_integration: opus-4.5
      repository_maintenance: sonnet-4.5
      ledger_updates: sonnet-4.5
      content_processing: sonnet-4.5
      verification_tasks: sonnet-4.5

    thinking_defaults:
      oracle_synthesis: ultrathink
      architectural_decisions: megathink
      complex_integration: megathink
      repository_maintenance: think
      ledger_updates: default
      content_processing: think
      verification_tasks: default

  # Protected zones (require Sovereign approval)
  protected:
    - "01-CANON/"
    - "00-ORCHESTRATION/oracle_contexts/"
    - "CLAUDE.md"
    - "02-ENGINE/coordination.yaml"

  # Conflict resolution
  conflict_resolution:
    strategy: "branch_per_instance"
    merge_target: "develop"
    merge_method: "rebase"
    notes: |
      Each instance works in isolated branch.
      PRs merge to develop branch.
      Main branch updated only after verification.

  # Communication patterns
  communication:
    oracle_to_code:
      method: "directive_files"
      location: "00-ORCHESTRATION/directives/"
      pattern: "DIRECTIVE-{number}{stream}.md"

    code_to_oracle:
      method: "execution_logs"
      location: "00-ORCHESTRATION/execution_logs/"
      pattern: "EXECUTION_LOG-{date}-{directive}.md"

    inter_instance:
      method: "git_branches"
      notes: "No direct communication; coordinate via shared repository"

  # Ledger conventions
  ledger_protocol:
    backup_before_write: true
    temp_file_pattern: "{name}.csv.tmp"
    backup_pattern: "{name}.csv.bak.{timestamp}"
    validation_required: true
    atomic_rename: true

  # Branch naming conventions
  branches:
    feature: "{instance}/feat-{description}"
    bugfix: "{instance}/fix-{description}"
    directive: "{instance}/directive-{number}"

  # Commit message format
  commit_format:
    pattern: "{type}({scope}): {description}"
    types:
      - feat      # New feature
      - fix       # Bug fix
      - docs      # Documentation
      - chore     # Maintenance
      - refactor  # Code refactoring
      - test      # Testing
    scope_examples:
      - PROJ-001
      - CANON
      - SOURCES
      - ledgers
